<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,500,700" rel="stylesheet">
      <link rel="stylesheet" type="text/css" href="radarchart.css">
</head>
<body>
  <select id="Fruitselecter">
      <option>Choose a fruit</option>
  </select>
</body>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="radarchart.js"></script>

<div id="chart"></div>

<script>
var width = 1000
var height = 600

// bar chart variables
var config = {radius: 5, w: 615, h: 500, factor: 1, factorLegend: .85,
 levels: 10, radians: 2 * Math.PI, opacityArea: 0.5, ToRight: 5,
 TranslateX: 80, TranslateY: 30, ExtraWidthX: 100, ExtraWidthY: 100,
 color: d3.scaleOrdinal().range(["#6F257F", "#CA0D59"])
}

// load data
d3.json("nutrients.json").then(function (datas) {
// extract fruit name strings
  fruitnames = Object.keys(datas)
// extract nutrient name strings
  nutrienttypes = Object.keys(datas[fruitnames[0]])
  nutrienttypes.splice(0, 9)
  nutrienttypes.splice(5, 1)
  nutrienttypes.splice(9, 1)
  nutrienttypes.splice(11, 1)
  nutrienttypes.splice(12, 1)
  nutrienttypes.splice(10, 1)
  nutrienttypes.splice(6, 1)
  nutrienttypes.splice(7, 1)
  nutrienttypes.splice(11, 2)
  console.log(nutrienttypes);
//
  var select = document.getElementById("Fruitselecter");

  for(var i = 0; i < fruitnames.length; i++) {
      var opt = fruitnames[i];
      var el = document.createElement("option");
      el.textContent = opt;
      el.value = opt;
      select.appendChild(el);
  }
// recommended daily maxes of relevant nutrients
  maxes = [30, 300, 16, 325, 15, 3000, 1.3, 1, 800, 1.3, 80]

  d3.select("select").on("change",function(d){

    var selected = d3.select("#Fruitselecter").node().value;

    data = []

  // loop through nutrition dict of each fruit
    for (i = 0; i < nutrienttypes.length; i++) {

      value = datas[selected][nutrienttypes[i]];

      name = nutrienttypes[i];

      max = maxes[i]

      var dict = {"nutrient": name, "value": value, "max": max}

      data.push(dict);
    };

    dataz = []
    dataz.push(data);

    RadarChart.draw("#chart", dataz, config);
  });

  var svg = d3.select('body')
  	.selectAll('svg')
  	.append('svg')
  	.attr("width", width)
  	.attr("height", height);
})

</script>
