<!DOCTYPE html>
<html>
  <head>
    <title>Fruit comparison</title>
    <link rel="stylesheet" type="text/css" href="barchart.css">
  </head>
  <body>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="//d3js.org/d3.v5.min.js"></script>
    <script src="barchart.js"></script>
<!-- dropdown menu  -->
    <select id="d3-dropdown">
      <option value="Carbohydrate, by difference in gram">"Carbohydrates (gram)"</option>
      <option value="Energy in kcal">"Energy (kcal)"</option>
      <option value="Fiber, total dietary in gram">"Fiber (gram)"</option>
      <option value="Folate, DFE in microgram">"Folate/B11 (microgram)"</option>
      <option value="Iron, Fe in milligram">"Iron (milligram)"</option>
      <option value="Magnesium, Mg in milligram">"Magnesium (milligram)"</option>
      <option value="Niacin in milligram">"Niacin/B3 (milligram)"</option>
      <option value="Phosphorus, P in milligram">"Phosphorus (milligram)"</option>
      <option value="Potassium, K in milligram">"Potassium (milligram)"</option>
      <option value="Riboflavin in milligram">"Riboflavin/B2 (milligram)"</option>
      <option value="Sugars, total in gram">"Sugars (gram)"</option>
      <option value="Thiamin in milligram">"Thiamin/B1 (milligram)"</option>
      <option value="Vitamin A, RAE in microgram">"Vitamin A (microgram)"</option>
      <option value="Vitamin B-6 in milligram">"Vitamin B-6 (milligram)"</option>
      <option value="Vitamin C, total ascorbic acid in milligram">"Vitamin C (milligram)"</option>
    </select>

    <p id="selected-dropdown"></p>
<!--define svg size-->
    <svg width="1000" height="500"></svg>

    <script>
// function to change bar chart when new nutrient is chosen in dropdown
    d3.select("select")
      .on("change",function(d){
// clear previously drawn svg
        d3.selectAll("svg > *").remove();
// get string of nutrient names
        var selected = d3.select("#d3-dropdown").node().value;
// load json file
        d3.json("nutrients.json").then(function (data) {
// extract fruit names
          var fruitnames = Object.keys(data);
// initialize reformatted data list
          var figuredata = []
// Reformat data to list of dicts with universal keys
          for (i = 0; i < fruitnames.length; i++) {
            var nutrient = data[fruitnames[i]][selected];
            var dict = {"Fruit": fruitnames[i], "nutrient": nutrient}
            figuredata.push(dict);
            };
// call barchart function
          BarChart.draw(figuredata, selected);
        })
      });
    </script>
  </body>
</html>
